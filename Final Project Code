import arcpy
from arcpy import env

#Set workspace
env.workspace = "E:/GEOG 380/Projects/Group Project"


#main data files
crime = "E:/GEOG 380/Projects/Group Project/Crimes2019_Chicago.csv"
policeStations = "E:/GEOG 380/Projects/Group Project/PoliceStationsDec2012.shp"
city = "E:/GEOG 380/Projects/Group Project/geo_export_8eb177f2-432d-4432-905b-d2d32b022901" 

#create the output directory for the selected variables
theft = "E:/GEOG 380/Projects/Group Project/theft_select" 
domestic = "E:/GEOG 380/Projects/Group Project/domestic_select"
narcotics = "E:/GEOG 380/Projects/Group Project/narcotics_select"

#Changing the field because the joining fields are string:long not long:lonng
fc = "E:/GEOG 380/Projects/Group Project/geo_export_8eb177f2-432d-4432-905b-d2d32b022901"
field = "area_num_1" #short int, non nullable field
new_name = "area_number"
new_alias = "areaNumber"
new_type = "Long"
new_length = "60"
new_is_nullable = "NULLABLE"
clear_alias = "FALSE"

#Alter the properties of a non nullable, short data type field to become a text field
arcpy.AlterField_management(fc, field, new_name, new_alias, new_type, new_length, new_is_nullable, clear_alias)

#Joining Boundary layer with the Crime Data


#making a feature layer
arcpy.MakeFeatureLayer_management("PoliceStationsDec2012.shp", "PoliceStationLayer")
arcpy.MakeFeautreLayer_management("Crimes2019_Chicago.csv", "CrimesLayer")
arcpy.MakeFeatureLayer_management("geo_export_8eb177f2-432d-4432-905b-d2d32b022901", "CityBoundaryLayer")

#Three Select analysis
arcpy.Select_analysis(crime, theft, '"PRIMARY_TYPE" = 'THEFT'")
arcpy.Select_analysis(crime, domestic, '"PRIMARY_TYPE" = 'DOMESTIC'")
arcpy.Select_analysis(crime, narcotics, '"PRIMARY_TYPE" = 'NARCOTICS'")

#Maybe Do the GetCount?
print arcpy.GetCount_management("theft")
print arcpy.GetCount_management("domestic")
print arcpy.GetCount_management("narcotics")
